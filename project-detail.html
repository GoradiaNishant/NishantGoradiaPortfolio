<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>Project Details | Nishant Goradia Portfolio</title>
    <meta name="title" content="Project Details | Nishant Goradia Portfolio">
    <meta name="description" content="Detailed view of mobile app development projects by Nishant Goradia. Explore technical implementation, features, challenges, and results of innovative mobile applications built with Flutter and React Native.">
    <meta name="keywords" content="Nishant Goradia, mobile app project, flutter project, react native project, app development, mobile development, project details, portfolio project">
    <meta name="author" content="Nishant Goradia">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://goradianishant.github.io/NishantGoradiaPortfolio/project-detail.html">
    <meta property="og:title" content="Project Details | Nishant Goradia Portfolio">
    <meta property="og:description" content="Detailed view of mobile app development projects by Nishant Goradia. Explore technical implementation, features, challenges, and results of innovative mobile applications.">
    <meta property="og:image" content="https://goradianishant.github.io/NishantGoradiaPortfolio/images/project-detail-og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Nishant Goradia Portfolio">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://goradianishant.github.io/NishantGoradiaPortfolio/project-detail.html">
    <meta property="twitter:title" content="Project Details | Nishant Goradia Portfolio">
    <meta property="twitter:description" content="Detailed view of mobile app development projects by Nishant Goradia. Explore technical implementation, features, challenges, and results of innovative mobile applications.">
    <meta property="twitter:image" content="https://goradianishant.github.io/NishantGoradiaPortfolio/images/project-detail-og-image.jpg">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#4f46e5">
    <meta name="msapplication-TileColor" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Project Details">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://goradianishant.github.io/NishantGoradiaPortfolio/project-detail.html">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://www.gstatic.com">
    
    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdn.tailwindcss.com">
    <link rel="dns-prefetch" href="//www.gstatic.com">
    
    <!-- Structured Data for Project -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CreativeWork",
        "name": "Mobile App Project",
        "description": "Detailed view of mobile app development project with technical implementation, features, and results",
        "url": "https://goradianishant.github.io/NishantGoradiaPortfolio/project-detail.html",
        "author": {
            "@type": "Person",
            "name": "Nishant Goradia"
        },
        "creator": {
            "@type": "Person",
            "name": "Nishant Goradia"
        },
        "datePublished": "2024-01-01",
        "dateModified": "2024-01-01",
        "genre": "Mobile App Development",
        "keywords": "mobile app, flutter, react native, app development",
        "image": "https://goradianishant.github.io/NishantGoradiaPortfolio/images/project-screenshot.jpg",
        "mainEntity": {
            "@type": "SoftwareApplication",
            "name": "Mobile Application",
            "applicationCategory": "Mobile App",
            "operatingSystem": "Android, iOS",
            "softwareVersion": "1.0"
        }
    }
    </script>
    
    <!-- Breadcrumb Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://goradianishant.github.io/NishantGoradiaPortfolio/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Projects",
                "item": "https://goradianishant.github.io/NishantGoradiaPortfolio/#projects"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "Project Details",
                "item": "https://goradianishant.github.io/NishantGoradiaPortfolio/project-detail.html"
            }
        ]
    }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script>
        // Wait for Firebase to load
        window.addEventListener('load', function() {
            if (typeof firebase !== 'undefined') {
                console.log('✅ Firebase SDK loaded successfully');
            } else {
                console.error('❌ Firebase SDK failed to load');
            }
        });
    </script>
    <script src="firebase-config.js?v=1"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        
        /* Hide scrollbar for webkit browsers */
        .scrollbar-hide {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;  /* Chrome, Safari and Opera */
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 1rem;
            color: #4f46e5;
            font-weight: 500;
        }
        
        /* Screenshot card base styles */
        .screenshot-card {
            flex-shrink: 0;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .screenshot-card:hover {
            transform: scale(1.05);
        }
        
        /* Portrait screenshots (mobile) */
        .screenshot-card.portrait {
            width: 256px;
            height: 456px; /* 9:16 aspect ratio */
        }
        
        /* Landscape screenshots (tablet/desktop) */
        .screenshot-card.landscape {
            width: 400px;
            height: 225px; /* 16:9 aspect ratio */
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .screenshot-card.portrait {
                width: 200px;
                height: 356px;
            }
            
            .screenshot-card.landscape {
                width: 300px;
                height: 169px;
            }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 smooth-scroll">
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading project details...</div>
    </div>
    
    <!-- Navbar -->
    <nav class="bg-white shadow-md fixed w-full z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0">
                    <h1 class="text-2xl font-bold text-indigo-600">Project Details</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html#home" class="text-gray-600 hover:text-indigo-600 transition duration-300">Home</a>
                    <a href="index.html#about" class="text-gray-600 hover:text-indigo-600 transition duration-300">About</a>
                    <a href="index.html#career" class="text-gray-600 hover:text-indigo-600 transition duration-300">Career</a>
                    <a href="index.html#skills" class="text-gray-600 hover:text-indigo-600 transition duration-300">Skills</a>
                    <a href="index.html#projects" class="text-gray-600 hover:text-indigo-600 transition duration-300">Projects</a>
                    <a href="index.html#resume" class="text-gray-600 hover:text-indigo-600 transition duration-300">Resume</a>
                    <a href="index.html#contact" class="text-gray-600 hover:text-indigo-600 transition duration-300">Contact</a>
                    <a href="admin.html" id="admin-link" class="text-indigo-600 hover:text-indigo-800 transition duration-300 font-semibold hidden">Admin</a>
                </div>
                <div class="md:hidden">
                    <button id="menu-toggle" class="text-gray-600 hover:text-indigo-600 focus:outline-none">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white shadow-md">
            <div class="px-4 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="index.html#home" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Home</a>
                <a href="index.html#about" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">About</a>
                <a href="index.html#career" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Career</a>
                <a href="index.html#skills" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Skills</a>
                <a href="index.html#projects" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Projects</a>
                <a href="index.html#resume" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Resume</a>
                <a href="index.html#contact" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Contact</a>
                <a href="admin.html" id="admin-link-mobile" class="block text-indigo-600 hover:text-indigo-800 px-3 py-2 rounded-md font-semibold hidden">Admin</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-20 pb-12 bg-gradient-to-r from-indigo-500 to-purple-600 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2 mb-8 md:mb-0">
                    <img src="https://picsum.photos/600/400" alt="Task Manager App" class="rounded-lg shadow-lg">
                </div>
                <div class="md:w-1/2 md:pl-10">
                    <h1 class="text-4xl md:text-5xl font-bold mb-4">Task Manager App</h1>
                    <p class="text-xl mb-6">A comprehensive productivity app built with Flutter, featuring task scheduling, reminders, and cloud synchronization.</p>
                    <div class="flex flex-wrap gap-2 mb-6">
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Flutter</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Dart</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Firebase</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Cloud Sync</span>
                    </div>
                    <div class="flex space-x-4" id="store-buttons">
                        <!-- Store buttons will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Overview -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h2 class="text-3xl font-bold mb-6">Project Overview</h2>
                    <div id="project-overview-container">
                        <!-- Project overview will be loaded dynamically -->
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold mb-4">Key Features</h3>
                    <div id="key-features-container">
                        <!-- Key features will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Screenshots -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <h2 class="text-3xl font-bold text-center mb-12">App Screenshots</h2>
                <div class="text-center mb-6">
                    <p class="text-sm text-gray-500 image-loading-progress">Images loading...</p>
                </div>
            
            <!-- Screenshot Gallery Container -->
            <div class="relative">
                <!-- Screenshot Gallery -->
                <div id="screenshots-gallery" class="flex overflow-x-auto gap-4 pb-4">
                    <!-- Screenshots will be loaded dynamically -->
                </div>
                
                <!-- Navigation Buttons -->
                <button id="screenshot-prev" class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-800 p-2 rounded-full shadow-lg transition-all duration-300 opacity-1 pointer-events-auto z-10">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="screenshot-next" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-800 p-2 rounded-full shadow-lg transition-all duration-300 opacity-1 pointer-events-auto z-10">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Add Screenshot Button (Admin Only) -->
            <div id="add-screenshot-section" class="text-center mt-8 hidden">
                <button id="add-screenshot-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300">
                    <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    Add Screenshot
                </button>
            </div>
        </div>
    </section>

    <!-- Screenshot Modal -->
    <div id="screenshot-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden z-50 flex items-center justify-center p-4">
        <div class="relative max-w-4xl w-full">
            <!-- Close Button -->
            <button id="close-modal" class="absolute top-4 right-4 text-white hover:text-gray-300 z-20 bg-black bg-opacity-50 rounded-full p-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <!-- Navigation Controls -->
            <button id="modal-prev" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-20 bg-black bg-opacity-50 rounded-full p-3 transition-all duration-300 hover:bg-opacity-75">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
            
            <button id="modal-next" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-20 bg-black bg-opacity-50 rounded-full p-3 transition-all duration-300 hover:bg-opacity-75">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
            
            <!-- Mobile Phone Frame Container -->
            <div class="relative mx-auto" style="max-width: 375px; max-height: 812px;">
                <!-- Phone Frame -->
                <div class="relative bg-gray-900 rounded-[3rem] p-3 shadow-2xl">
                    <!-- Phone Screen -->
                    <div class="bg-gray-800 rounded-[2.5rem] overflow-hidden relative" style="width: 375px; height: 812px;">
                        
                        <!-- Screenshot Image -->
                        <img id="modal-image" src="" alt="" class="w-full h-full object-cover opacity-0 transition-opacity duration-300" 
                             onload="console.log('✅ Modal image loaded successfully:', this.src); this.style.opacity='1'; hideModalLoading();" 
                             onerror="console.log('❌ Modal image failed to load:', this.src); this.style.opacity='1'; hideModalLoading(); showFailedImageInModal();">
                        
                        <!-- Loading State for Modal -->
                        <div id="modal-loading" class="absolute inset-0 flex items-center justify-center bg-gray-700 z-10">
                            <div class="text-center">
                                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-400 mx-auto mb-4"></div>
                                <p class="text-white text-lg">Loading screenshot...</p>
                            </div>
                        </div>
                        
                        <!-- Failed Image State (shows placeholder in phone frame) -->
                        <div id="modal-failed" class="absolute inset-0 bg-gray-600 flex items-center justify-center z-5 hidden">
                            <div class="text-center">
                                <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <p class="text-gray-300 text-lg font-medium">Screenshot Unavailable</p>
                                <p class="text-gray-400 text-sm mt-2">This screenshot failed to load</p>
                                <button onclick="retryCurrentModalImage()" class="mt-4 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                    Retry This Screenshot
                                </button>
                            </div>
                        </div>
                        
                        <!-- Status Bar Overlay -->
                        <div class="absolute top-0 left-0 right-0 h-8 bg-black bg-opacity-80 flex items-center justify-between px-6 z-15">
                            <div class="flex items-center space-x-1">
                                <div class="w-2 h-2 bg-white rounded-full"></div>
                                <div class="w-2 h-2 bg-white rounded-full"></div>
                                <div class="w-2 h-2 bg-white rounded-full"></div>
                            </div>
                            <div class="text-white text-xs font-medium">9:41</div>
                            <div class="flex items-center space-x-1">
                                <div class="w-4 h-2 bg-white rounded-sm"></div>
                                <div class="w-1 h-1 bg-white rounded-full"></div>
                            </div>
                        </div>
                        
                        <!-- Home Indicator Overlay -->
                        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 w-32 h-1 bg-white rounded-full opacity-80"></div>
                    </div>
                </div>
            </div>
            
            <!-- Screenshot Info -->
            <div id="modal-info" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-center bg-black bg-opacity-50 rounded-lg px-4 py-2 z-20">
                <h3 id="modal-title" class="font-semibold text-lg"></h3>
                <p id="modal-description" class="text-sm text-gray-300"></p>
                <p id="modal-counter" class="text-xs text-gray-400 mt-1"></p>
            </div>
        </div>
    </div>

    <!-- Technical Details -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Technical Implementation</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h3 class="text-2xl font-bold mb-6">Tech Stack</h3>
                    <div id="tech-stack-container" class="space-y-4">
                        <!-- Tech stack items will be dynamically loaded here -->
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold mb-6">Development Process</h3>
                    <div id="development-process-container" class="space-y-6">
                        <!-- Development process items will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Challenges & Solutions -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Challenges & Solutions</h2>
            <div id="challenges-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Dynamic challenges and solutions will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Results & Impact -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Results & Impact</h2>
            <div id="results-container" class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <!-- Results and impact will be loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Back to Portfolio -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-bold mb-6">View More Projects</h2>
            <p class="text-lg text-gray-600 mb-8">Explore other projects in my portfolio</p>
            <a href="index.html#projects" class="bg-indigo-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300">Back to Portfolio</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-indigo-600 text-white py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 [Your Name]. All rights reserved.</p>
        </div>
    </footer>

    <script>
                // Load project data from Firebase
        async function loadProjectData() {
            try {
            const urlParams = new URLSearchParams(window.location.search);
            const projectIndex = urlParams.get('project');
                
                console.log('Loading project data for index:', projectIndex);
            
            if (projectIndex !== null) {
                    const projects = await FirebaseDB.getProjects();
                    console.log('Loaded projects:', projects);
                    
                    const project = projects[parseInt(projectIndex)];
                    console.log('Selected project:', project);
                    
                    if (project) {
                        // Update hero section
                        const heroTitle = document.querySelector('.md\\:w-1\\/2 h1');
                        const heroDescription = document.querySelector('.md\\:w-1\\/2 p');
                        const heroImage = document.querySelector('section img');
                        
                        if (heroTitle) heroTitle.textContent = project.name;
                        if (heroDescription) heroDescription.textContent = project.description;
                        if (heroImage && project.image) heroImage.src = project.image;
                        
                        // Update tech stack tags
                        if (project.tech) {
                            const techTags = project.tech.split(',').map(tech => tech.trim());
                            const tagsContainer = document.querySelector('.md\\:w-1\\/2 .flex.flex-wrap.gap-2');
                            if (tagsContainer) {
                                tagsContainer.innerHTML = '';
                                
                                techTags.forEach(tech => {
                                    const tag = document.createElement('span');
                                    tag.className = 'bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm';
                                    tag.textContent = tech;
                                    tagsContainer.appendChild(tag);
                                });
                            }
                        }
                        
                        // Update store buttons - only show if URLs exist
                        const storeButtonsContainer = document.getElementById('store-buttons');
                        if (storeButtonsContainer) {
                            storeButtonsContainer.innerHTML = '';
                            
                            // Add Google Play button if demo URL exists
                            if (project.demo && project.demo.trim() !== '') {
                                const playStoreLink = document.createElement('a');
                                playStoreLink.href = project.demo;
                                playStoreLink.className = 'hover:opacity-80 transition duration-300';
                                playStoreLink.innerHTML = `<img src="images/playstore.png" alt="Get it on Google Play" class="h-12">`;
                                storeButtonsContainer.appendChild(playStoreLink);
                            }
                            
                            // Add App Store button if source URL exists
                            if (project.source && project.source.trim() !== '') {
                                const appStoreLink = document.createElement('a');
                                appStoreLink.href = project.source;
                                appStoreLink.className = 'hover:opacity-80 transition duration-300';
                                appStoreLink.innerHTML = `<img src="images/appstore.png" alt="Download on the App Store" class="h-12">`;
                                storeButtonsContainer.appendChild(appStoreLink);
                            }
                        }
                        

                        
                        // Update Technical Implementation section
                        console.log('🔍 Full project data loaded:', project);
                        console.log('🔍 All project keys:', Object.keys(project));
                        console.log('🔍 Tech Stack from Firebase:', project.techStack);
                        console.log('🔍 Development Process from Firebase:', project.developmentProcess);
                        console.log('🔍 Project tech field:', project.tech);
                        console.log('🔍 Raw project object:', JSON.stringify(project, null, 2));
                        
                        // Check multiple possible field names for tech stack
                        const techStackData = project.techStack || project.tech || project.technicalStack;
                        console.log('🔍 Tech stack data found:', techStackData);
                        
                        if (techStackData) {
                            console.log('Tech stack data:', techStackData);
                            // Handle both comma-separated and newline-separated formats
                            const techStackItems = techStackData.includes('\n') 
                                ? techStackData.split('\n') 
                                : techStackData.split(',');
                            console.log('Tech stack items:', techStackItems);
                            
                            const techStackContainer = document.getElementById('tech-stack-container');
                            console.log('Tech Stack container found:', techStackContainer);
                            
                            if (techStackContainer) {
                                console.log('Updating tech stack container');
                                techStackContainer.innerHTML = '';
                                
                                techStackItems.forEach(item => {
                                    if (item.trim()) {
                                        const [technology, description] = item.split('|');
                                        if (technology && description) {
                                            const techDiv = document.createElement('div');
                                            techDiv.className = 'flex justify-between items-center p-4 bg-gray-50 rounded-lg';
                                            techDiv.innerHTML = `
                                                <span class="font-semibold">${technology.trim()}</span>
                                                <span class="text-indigo-600">${description.trim()}</span>
                                            `;
                                            techStackContainer.appendChild(techDiv);
                                            console.log('Added tech item:', technology, description);
                                        }
                                    }
                                });
                            } else {
                                console.error('Tech stack container not found');
                            }
                        } else {
                            console.log('No tech stack data found in project');
                        }
                        
                        // Check multiple possible field names for development process
                        const developmentProcessData = project.developmentProcess || project.process || project.development;
                        console.log('🔍 Development process data found:', developmentProcessData);
                        
                        if (developmentProcessData) {
                            console.log('Development process data:', developmentProcessData);
                            // Handle both comma-separated and newline-separated formats
                            const processItems = developmentProcessData.includes('\n') 
                                ? developmentProcessData.split('\n') 
                                : developmentProcessData.split(',');
                            console.log('Process items:', processItems);
                            
                            const processContainer = document.getElementById('development-process-container');
                            console.log('Development Process container found:', processContainer);
                            
                            if (processContainer) {
                                console.log('Updating development process container');
                                processContainer.innerHTML = '';
                                
                                processItems.forEach((item, index) => {
                                    if (item.trim()) {
                                        const [step, description] = item.split('|');
                                        if (step && description) {
                                            const processDiv = document.createElement('div');
                                            processDiv.className = 'flex items-start mb-6';
                                            processDiv.innerHTML = `
                                                <div class="bg-indigo-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-sm mr-6 flex-shrink-0 shadow-md">${index + 1}</div>
                                                <div class="flex-1">
                                                    <h4 class="font-semibold text-lg mb-2 text-gray-800">${step.trim()}</h4>
                                                    <p class="text-gray-600 leading-relaxed">${description.trim()}</p>
                                                </div>
                                            `;
                                            processContainer.appendChild(processDiv);
                                            console.log('Added process item:', step, description);
                                        }
                                    }
                                });
                            } else {
                                console.error('Development process container not found');
                            }
                        } else {
                            console.log('No development process data found in project');
                        }
                        
                        // Load project overview and key features
                        loadProjectOverview(project);
                        loadKeyFeatures(project);
                        loadResultsAndImpact(project);
                        
                        // Load challenges and solutions
                        loadChallengesAndSolutions(project);
                        
                        // Load screenshots
                        await loadScreenshots(project);
                        
                        // Update footer with portfolio owner name
                        try {
                            const portfolioData = await FirebaseDB.getPortfolioData();
                            if (portfolioData.heroName) {
                                document.querySelector('footer p').textContent = `© 2025 ${portfolioData.heroName}. All rights reserved.`;
                            }
                        } catch (error) {
                            console.error('Error updating footer:', error);
                        }
                    } else {
                        console.error('Project not found for index:', projectIndex);
                    }
                } else {
                    console.error('No project index provided in URL');
                }
            } catch (error) {
                console.error('Error loading project data:', error);
                console.error('Error details:', error.message);
                console.error('Error stack:', error.stack);
            }
        }

        // Load project overview for the project
        function loadProjectOverview(project) {
            try {
                console.log('Loading project overview for project:', project);
                const overviewContainer = document.getElementById('project-overview-container');
                
                if (!overviewContainer) {
                    console.error('Project overview container element not found');
                    return;
                }
                
                overviewContainer.innerHTML = '';
                
                if (project.detailDescription && project.detailDescription.trim()) {
                    console.log('Found project overview data:', project.detailDescription);
                    overviewContainer.innerHTML = `
                        <p class="text-lg text-gray-600 leading-relaxed mb-6">${project.detailDescription}</p>
                    `;
                } else {
                    console.log('No project overview data found');
                    overviewContainer.innerHTML = '<p class="text-lg text-gray-600 leading-relaxed">No project overview available.</p>';
                }
            } catch (error) {
                console.error('Error loading project overview:', error);
            }
        }

        // Load key features for the project
        function loadKeyFeatures(project) {
            try {
                console.log('Loading key features for project:', project);
                const featuresContainer = document.getElementById('key-features-container');
                
                if (!featuresContainer) {
                    console.error('Key features container element not found');
                    return;
                }
                
                featuresContainer.innerHTML = '';
                
                if (project.features && project.features.trim()) {
                    console.log('Found features data:', project.features);
                    const features = project.features.split('\n');
                    
                    const featuresList = document.createElement('ul');
                    featuresList.className = 'space-y-3';
                    
                    features.forEach(feature => {
                        if (feature.trim()) {
                            const li = document.createElement('li');
                            li.className = 'flex items-start mb-4';
                            li.innerHTML = `
                                <div class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm mr-4 flex-shrink-0 shadow-sm">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <span class="text-gray-800 font-medium leading-relaxed">${feature.trim()}</span>
                                </div>
                            `;
                            featuresList.appendChild(li);
                        }
                    });
                    
                    featuresContainer.appendChild(featuresList);
                } else {
                    console.log('No features data found');
                    featuresContainer.innerHTML = '<p class="text-gray-600">No key features available.</p>';
                }
            } catch (error) {
                console.error('Error loading key features:', error);
            }
        }

        // Load results and impact for the project
        function loadResultsAndImpact(project) {
            try {
                console.log('Loading results and impact for project:', project);
                const resultsContainer = document.getElementById('results-container');
                
                if (!resultsContainer) {
                    console.error('Results container element not found');
                    return;
                }
                
                resultsContainer.innerHTML = '';
                
                // Create result cards based on available data
                const resultCards = [];
                
                if (project.users) {
                    resultCards.push({
                        value: project.users,
                        label: 'Active Users'
                    });
                }
                
                if (project.rating) {
                    const ratingValue = parseFloat(project.rating);
                    if (!isNaN(ratingValue)) {
                        resultCards.push({
                            value: generateStarRating(ratingValue),
                            label: 'App Store Rating'
                        });
                    } else {
                        resultCards.push({
                            value: project.rating,
                            label: 'App Store Rating'
                        });
                    }
                }
                
                if (project.retention) {
                    resultCards.push({
                        value: project.retention,
                        label: 'User Retention'
                    });
                }
                
                if (resultCards.length > 0) {
                    resultCards.forEach(card => {
                        const cardDiv = document.createElement('div');
                        cardDiv.className = 'bg-indigo-50 rounded-lg p-6';
                        cardDiv.innerHTML = `
                            <div class="text-4xl font-bold text-indigo-600 mb-2">${card.value}</div>
                            <p class="text-gray-600">${card.label}</p>
                        `;
                        resultsContainer.appendChild(cardDiv);
                    });
                } else {
                    console.log('No results data found');
                    const noResultsDiv = document.createElement('div');
                    noResultsDiv.className = 'col-span-full text-center text-gray-500 py-8';
                    noResultsDiv.innerHTML = '<p>No results and impact data available for this project.</p>';
                    resultsContainer.appendChild(noResultsDiv);
                }
            } catch (error) {
                console.error('Error loading results and impact:', error);
            }
        }

        // Load challenges and solutions for the project
        function loadChallengesAndSolutions(project) {
            try {
                console.log('Loading challenges and solutions for project:', project);
                const challengesContainer = document.getElementById('challenges-container');
                
                if (!challengesContainer) {
                    console.error('Challenges container element not found');
                    return;
                }
                
                challengesContainer.innerHTML = '';
                
                if (project.challenges && project.challenges.trim()) {
                    console.log('Found challenges data:', project.challenges);
                    const challenges = project.challenges.split('\n');
                    
                    challenges.forEach(challenge => {
                        if (challenge.trim()) {
                            const [challengeText, solutionText] = challenge.split('|');
                            if (challengeText && solutionText) {
                                const challengeCard = document.createElement('div');
                                challengeCard.className = 'bg-white rounded-lg p-6 shadow-md';
                                challengeCard.innerHTML = `
                                    <h3 class="text-xl font-bold mb-4 text-red-600">Challenge</h3>
                                    <p class="text-gray-600 mb-4">${challengeText.trim()}</p>
                                    <h4 class="font-semibold mb-2">Solution</h4>
                                    <p class="text-gray-600">${solutionText.trim()}</p>
                                `;
                                challengesContainer.appendChild(challengeCard);
                                console.log('Added challenge card:', challengeText, solutionText);
                            }
                        }
                    });
                } else {
                    console.log('No challenges data found in project');
                    // Show a default message if no challenges are available
                    const noChallengesCard = document.createElement('div');
                    noChallengesCard.className = 'col-span-full text-center text-gray-500 py-8';
                    noChallengesCard.innerHTML = '<p>No challenges and solutions data available for this project.</p>';
                    challengesContainer.appendChild(noChallengesCard);
                }
            } catch (error) {
                console.error('Error loading challenges and solutions:', error);
            }
        }

        // Load screenshots for the project
        async function loadScreenshots(project) {
            try {
                console.log('Loading screenshots for project:', project);
                const gallery = document.getElementById('screenshots-gallery');
                
                if (!gallery) {
                    console.error('Screenshots gallery element not found');
                    return;
                }
                
                gallery.innerHTML = '';
                
                if (project.screenshots && project.screenshots.length > 0) {
                    console.log('Found screenshots:', project.screenshots);
                    
                    // Show screenshots immediately with lazy loading
                    gallery.innerHTML = '';
                    
                    // Create and display all screenshot cards immediately
                    project.screenshots.forEach((screenshot, index) => {
                        const screenshotCard = createScreenshotCard(screenshot, index, true); // Assume loaded initially
                        if (screenshotCard) {
                            gallery.appendChild(screenshotCard);
                        }
                    });
                    
                    // Track which images actually loaded successfully
                    const results = project.screenshots.map((screenshot, index) => ({ 
                        screenshot, 
                        index, 
                        loaded: false // Will be updated as images load
                    }));
                    
                    // Setup navigation buttons
                    setupScreenshotNavigation();
                    
                    // Monitor image loading progress and show helpful message if needed
                    let loadedCount = 0;
                    const totalCount = project.screenshots.length;
                    
                    // Update progress as images load
                    const updateProgress = () => {
                        // Count only the actual screenshot images, not any other images on the page
                        const screenshotImages = document.querySelectorAll('#screenshots-gallery img[data-screenshot-index]');
                        const successfulImages = Array.from(screenshotImages).filter(img => 
                            img.src.includes('play-lh.googleusercontent.com') && !img.src.includes('images/appstore.png')
                        );
                        loadedCount = successfulImages.length;
                        
                        updateImageLoadingProgress(loadedCount, totalCount);
                        
                        // If all images are loaded, update the progress text
                        if (loadedCount === totalCount) {
                            const progressText = document.querySelector('.image-loading-progress');
                            if (progressText) {
                                progressText.textContent = `All ${totalCount} images loaded successfully!`;
                                progressText.className = 'text-sm text-green-600 font-medium';
                            }
                        }
                    };
                    
                    // Check progress every 500ms
                    const progressInterval = setInterval(updateProgress, 500);
                    
                    // Stop checking after 10 seconds
                    setTimeout(() => {
                        clearInterval(progressInterval);
                        updateProgress(); // Final update
                        
                        // Only show warning if there are actually failed images
                        const failedImages = document.querySelectorAll('#screenshots-gallery img[src="images/appstore.png"]');
                        if (failedImages.length > 0) {
                            const helpMessage = document.createElement('div');
                            helpMessage.className = 'mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg';
                            helpMessage.innerHTML = `
                                <div class="flex items-start space-x-3">
                                    <svg class="w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                                    </svg>
                                    <div class="flex-1">
                                        <h3 class="text-sm font-medium text-yellow-800">Some screenshots failed to load</h3>
                                        <p class="text-sm text-yellow-700 mt-1">
                                            ${failedImages.length} of ${totalCount} screenshots couldn't be loaded due to rate limiting from Google's servers. 
                                            This is a temporary issue and usually resolves itself. <strong>Tip: Wait a few minutes before retrying to avoid further rate limiting.</strong>
                                        </p>
                                        <div class="mt-3 flex space-x-3">
                                            <button onclick="retryFailedImages()" class="text-sm bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700 transition-colors">
                                                Retry Failed Images
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            // Remove any existing help message
                            const existingHelp = document.querySelector('.bg-yellow-50');
                            if (existingHelp) {
                                existingHelp.remove();
                            }
                            
                            gallery.parentNode.insertBefore(helpMessage, gallery.nextSibling);
                        }
                    }, 10000); // Check after 10 seconds
                } else {
                    console.log('No screenshots found for project');
                    // Show placeholder if no screenshots
                    gallery.innerHTML = `
                        <div class="flex items-center justify-center w-full py-12">
                            <div class="text-center">
                                <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <p class="text-gray-500 text-lg">No screenshots available yet</p>
                                <p class="text-gray-400">Screenshots will appear here once added</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading screenshots:', error);
                console.error('Error details:', error.message);
                console.error('Error stack:', error.stack);
            }
        }

        // Create screenshot card
        function createScreenshotCard(screenshot, index, loaded = true) {
            try {
                console.log('Creating screenshot card with data:', screenshot);
                
                if (!screenshot || !screenshot.url || !screenshot.title) {
                    console.error('Invalid screenshot data:', screenshot);
                    return null;
                }
                
                // Determine orientation based on screenshot data or default to portrait
                const isLandscape = screenshot.orientation === 'landscape' || 
                                   (screenshot.width && screenshot.height && screenshot.width > screenshot.height);
                
                const card = document.createElement('div');
                card.className = `screenshot-card ${isLandscape ? 'landscape' : 'portrait'}`;
                card.innerHTML = `
                    <div class="relative w-full h-full bg-gray-900 rounded-lg p-2">
                        <!-- Device Frame -->
                        <div class="w-full h-full bg-gray-800 rounded-lg overflow-hidden relative">
                            <!-- Loading State (shown initially) -->
                            <div class="absolute inset-0 bg-gray-700 flex items-center justify-center z-20" id="loading-${index}">
                                <div class="text-center">
                                    <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-400 mx-auto mb-2"></div>
                                    <p class="text-gray-300 text-xs">Loading...</p>
                                </div>
                            </div>
                            
                            <!-- Screenshot Image (Full Size) -->
                            <img src="${screenshot.url}" alt="${screenshot.title}" class="w-full h-full object-contain opacity-0 transition-opacity duration-300" 
                                 data-screenshot-index="${index}" 
                                 data-original-src="${screenshot.url}"
                                 data-description="${screenshot.description || ''}"
                                 data-orientation="${isLandscape ? 'landscape' : 'portrait'}"
                                 onerror="this.onerror=null; this.src='images/appstore.png'; this.alt='Screenshot not available'; console.log('Failed to load screenshot:', '${screenshot.url}'); this.classList.add('opacity-50'); hideLoadingState(${index}); showFailedState(${index});"
                                 onload="handleScreenshotLoad(this, ${index}, '${screenshot.url}');">
                            
                            <!-- Failed State Indicator (shown when image fails) -->
                            <div class="absolute inset-0 bg-red-500 bg-opacity-20 flex items-center justify-center z-15 hidden" id="failed-${index}" style="background: rgba(239, 68, 68, 0.3);">
                                <div class="text-center">
                                    <svg class="w-8 h-8 text-red-500 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                    </svg>
                                    <p class="text-red-600 text-xs font-medium">Failed to load</p>
                                    <button onclick="retrySingleImage(${index})" class="mt-2 text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700 transition-colors">
                                        Retry
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Status Bar Overlay (Portrait Only) -->
                            <div class="absolute top-0 left-0 right-0 h-6 bg-black bg-opacity-80 flex items-center justify-between px-3 z-10 ${isLandscape ? 'hidden' : ''}">
                                <div class="flex items-center space-x-1">
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                </div>
                                <div class="text-white text-xs font-medium">9:41</div>
                                <div class="flex items-center space-x-1">
                                    <div class="w-3 h-2 bg-white rounded-sm"></div>
                                    <div class="w-1 h-1 bg-white rounded-full"></div>
                                </div>
                            </div>
                            
                            <!-- Home Indicator Overlay (Portrait Only) -->
                            <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 w-32 h-1 bg-white rounded-full opacity-80 ${isLandscape ? 'hidden' : ''}"></div>
                        </div>
                    </div>
                `;
                
                // Add click event to open modal
                card.addEventListener('click', () => {
                    openScreenshotModal(screenshot);
                });
                
                return card;
            } catch (error) {
                console.error('Error creating screenshot card:', error);
                console.error('Screenshot data:', screenshot);
                return null;
            }
        }

        // Handle screenshot image load and orientation detection
        function handleScreenshotLoad(img, index, originalUrl) {
            try {
                console.log('Screenshot loaded successfully:', originalUrl);
                
                // Remove opacity and show image
                img.classList.remove('opacity-50');
                img.style.opacity = '1';
                
                // Hide loading state
                hideLoadingState(index);
                hideFailedState(index);
                
                // Detect actual orientation from image dimensions
                const isLandscape = img.naturalWidth > img.naturalHeight;
                const currentOrientation = img.dataset.orientation;
                
                // Update orientation if it differs from initial assumption
                if ((isLandscape && currentOrientation !== 'landscape') || 
                    (!isLandscape && currentOrientation !== 'portrait')) {
                    
                    console.log(`Orientation updated for screenshot ${index}: ${currentOrientation} -> ${isLandscape ? 'landscape' : 'portrait'}`);
                    
                    // Update the card class
                    const card = img.closest('.screenshot-card');
                    if (card) {
                        card.classList.remove('portrait', 'landscape');
                        card.classList.add(isLandscape ? 'landscape' : 'portrait');
                    }
                    
                    // Update the image data attribute
                    img.dataset.orientation = isLandscape ? 'landscape' : 'portrait';
                    
                    // Update status bar and home indicator visibility
                    const statusBar = card?.querySelector('.absolute.top-0');
                    const homeIndicator = card?.querySelector('.absolute.bottom-2');
                    
                    if (statusBar) {
                        statusBar.classList.toggle('hidden', isLandscape);
                    }
                    if (homeIndicator) {
                        homeIndicator.classList.toggle('hidden', isLandscape);
                    }
                }
                
            } catch (error) {
                console.error('Error in handleScreenshotLoad:', error);
                // Fallback to basic load handling
                img.classList.remove('opacity-50');
                img.style.opacity = '1';
                hideLoadingState(index);
                hideFailedState(index);
            }
        }

        // Global variables for modal navigation
        let currentScreenshotIndex = 0;
        let currentScreenshots = [];
        
        // Open screenshot modal
        function openScreenshotModal(screenshot) {
            try {
                console.log('Opening screenshot modal:', screenshot);
                
                if (!screenshot || !screenshot.url) {
                    console.error('Invalid screenshot data for modal:', screenshot);
                    return;
                }
                
                const modal = document.getElementById('screenshot-modal');
                const modalImage = document.getElementById('modal-image');
                
                if (!modal || !modalImage) {
                    console.error('Modal elements not found');
                    return;
                }
                
                // Get all screenshots for navigation
                const screenshotCards = document.querySelectorAll('#screenshots-gallery img[data-screenshot-index]');
                console.log('🔍 Found screenshot cards:', screenshotCards.length);
                
                currentScreenshots = Array.from(screenshotCards).map((img, index) => ({
                    url: img.dataset.originalSrc, // Always use the original source URL
                    title: img.alt,
                    description: img.dataset.description || '',
                    index: parseInt(img.dataset.screenshotIndex)
                }));
                
                console.log('📋 Built screenshots array:', currentScreenshots);
                console.log('🎯 Current screenshot URL:', screenshot.url);
                
                // Find current screenshot index
                currentScreenshotIndex = currentScreenshots.findIndex(s => s.url === screenshot.url);
                if (currentScreenshotIndex === -1) {
                    console.log('⚠️ Screenshot not found in array, using index 0');
                    currentScreenshotIndex = 0;
                } else {
                    console.log('✅ Found screenshot at index:', currentScreenshotIndex);
                }
                
                console.log('🖼️ Updating modal with screenshot:', currentScreenshots[currentScreenshotIndex]);
                
                // Update modal content
                updateModalContent(currentScreenshots[currentScreenshotIndex], currentScreenshotIndex + 1, currentScreenshots.length);
                
                // Also set the modal image directly as a fallback
                if (modalImage) {
                    console.log('🔄 Setting modal image directly as fallback:', screenshot.url);
                    modalImage.src = screenshot.url;
                    modalImage.alt = screenshot.title || 'Screenshot';
                    
                    // Check if this is a failed image and show appropriate state
                    if (screenshot.url.includes('images/appstore.png')) {
                        console.log('⚠️ Screenshot failed, showing failed state in modal');
                        setTimeout(() => {
                            hideModalLoading();
                            showFailedImageInModal();
                        }, 500);
                    }
                }
                
                // Show modal
                modal.classList.remove('hidden');
                
                // Setup modal navigation
                setupModalNavigation();
                
            } catch (error) {
                console.error('Error opening screenshot modal:', error);
            }
        }

        // Update modal content
        function updateModalContent(screenshot, currentNumber, totalNumber) {
            console.log('🔄 Updating modal content:', screenshot);
            
            const modalImage = document.getElementById('modal-image');
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const modalCounter = document.getElementById('modal-counter');
            const modalLoading = document.getElementById('modal-loading');
            const modalFailed = document.getElementById('modal-failed');
            
            if (modalImage) {
                console.log('📸 Setting modal image source:', screenshot.url);
                // Reset states
                if (modalLoading) modalLoading.style.display = 'flex';
                if (modalFailed) modalFailed.style.display = 'none';
                modalImage.style.opacity = '0';
                
                modalImage.src = screenshot.url;
                modalImage.alt = screenshot.title || 'Screenshot';
            }
            
            if (modalTitle) modalTitle.textContent = screenshot.title || 'Screenshot';
            if (modalDescription) modalDescription.textContent = screenshot.description || '';
            if (modalCounter) modalCounter.textContent = `${currentNumber} of ${totalNumber}`;
            
            console.log('✅ Modal content updated successfully');
        }
        
        // Navigate to next screenshot
        function nextScreenshot() {
            if (currentScreenshots.length === 0) return;
            
            currentScreenshotIndex = (currentScreenshotIndex + 1) % currentScreenshots.length;
            const screenshot = currentScreenshots[currentScreenshotIndex];
            updateModalContent(screenshot, currentScreenshotIndex + 1, currentScreenshots.length);
            updateModalNavigationButtons();
        }
        
        // Navigate to previous screenshot
        function prevScreenshot() {
            if (currentScreenshots.length === 0) return;
            
            currentScreenshotIndex = (currentScreenshotIndex - 1 + currentScreenshots.length) % currentScreenshots.length;
            const screenshot = currentScreenshots[currentScreenshotIndex];
            updateModalContent(screenshot, currentScreenshotIndex + 1, currentScreenshots.length);
            updateModalNavigationButtons();
        }
        
        // Update modal navigation button states
        function updateModalNavigationButtons() {
            const prevBtn = document.getElementById('modal-prev');
            const nextBtn = document.getElementById('modal-next');
            
            if (prevBtn && nextBtn) {
                // Show/hide buttons based on position
                prevBtn.style.opacity = currentScreenshotIndex === 0 ? '0.3' : '1';
                prevBtn.style.pointerEvents = currentScreenshotIndex === 0 ? 'none' : 'auto';
                
                nextBtn.style.opacity = currentScreenshotIndex === currentScreenshots.length - 1 ? '0.3' : '1';
                nextBtn.style.pointerEvents = currentScreenshotIndex === currentScreenshots.length - 1 ? '0.3' : 'auto';
            }
        }
        
        // Setup modal navigation event listeners
        function setupModalNavigation() {
            const prevBtn = document.getElementById('modal-prev');
            const nextBtn = document.getElementById('modal-next');
            
            if (prevBtn && nextBtn) {
                // Remove existing listeners
                prevBtn.replaceWith(prevBtn.cloneNode(true));
                nextBtn.replaceWith(nextBtn.cloneNode(true));
                
                // Get new references
                const newPrevBtn = document.getElementById('modal-prev');
                const newNextBtn = document.getElementById('modal-next');
                
                // Add new listeners
                newPrevBtn.addEventListener('click', prevScreenshot);
                newNextBtn.addEventListener('click', nextScreenshot);
                
                // Update button states
                updateModalNavigationButtons();
            }
        }
        
        // Close screenshot modal
        function closeScreenshotModal() {
            const modal = document.getElementById('screenshot-modal');
            modal.classList.add('hidden');
            
            // Reset navigation state
            currentScreenshotIndex = 0;
            currentScreenshots = [];
        }

        // Setup screenshot navigation
        function setupScreenshotNavigation() {
            const gallery = document.getElementById('screenshots-gallery');
            const prevBtn = document.getElementById('screenshot-prev');
            const nextBtn = document.getElementById('screenshot-next');
            
            console.log('Setting up screenshot navigation');
            console.log('Gallery:', gallery);
            console.log('Prev button:', prevBtn);
            console.log('Next button:', nextBtn);
            
            if (!gallery || !prevBtn || !nextBtn) {
                console.error('Navigation elements not found');
                return;
            }
            
            // Navigation button click handlers
            prevBtn.addEventListener('click', () => {
                console.log('Previous button clicked');
                gallery.scrollBy({ left: -272, behavior: 'smooth' }); // 256px card + 16px gap
            });
            
            nextBtn.addEventListener('click', () => {
                console.log('Next button clicked');
                gallery.scrollBy({ left: 272, behavior: 'smooth' }); // 256px card + 16px gap
            });
            
            // Show/hide navigation buttons based on scroll position
            function updateNavigationButtons() {
                const isAtStart = gallery.scrollLeft === 0;
                const isAtEnd = gallery.scrollLeft >= gallery.scrollWidth - gallery.clientWidth;
                
                console.log('Scroll position:', gallery.scrollLeft);
                console.log('Scroll width:', gallery.scrollWidth);
                console.log('Client width:', gallery.clientWidth);
                console.log('Is at start:', isAtStart);
                console.log('Is at end:', isAtEnd);
                
                prevBtn.style.opacity = isAtStart ? '0.3' : '1';
                prevBtn.style.pointerEvents = isAtStart ? 'none' : 'auto';
                
                nextBtn.style.opacity = isAtEnd ? '0.3' : '1';
                nextBtn.style.pointerEvents = isAtEnd ? 'none' : 'auto';
            }
            
            // Update buttons on scroll
            gallery.addEventListener('scroll', updateNavigationButtons);
            
            // Initial button state
            updateNavigationButtons();
            
            console.log('Screenshot navigation setup complete');
        }

        // Mobile menu toggle
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Screenshot modal event listeners
        const closeModalBtn = document.getElementById('close-modal');
        const screenshotModal = document.getElementById('screenshot-modal');
        
        closeModalBtn.addEventListener('click', closeScreenshotModal);
        
        // Close modal when clicking outside
        screenshotModal.addEventListener('click', (e) => {
            if (e.target === screenshotModal) {
                closeScreenshotModal();
            }
        });
        
        // Modal keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (screenshotModal.classList.contains('hidden')) return;
            
            switch (e.key) {
                case 'Escape':
                    closeScreenshotModal();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    prevScreenshot();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextScreenshot();
                    break;
            }
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
                // Close mobile menu after clicking a link
                mobileMenu.classList.add('hidden');
            });
        });

        // Show loading overlay
        function showLoading(message = 'Loading...') {
            const overlay = document.getElementById('loading-overlay');
            const loadingText = overlay.querySelector('.loading-text');
            loadingText.textContent = message;
            overlay.style.display = 'flex';
        }

        // Hide loading overlay
        function hideLoading() {
            const overlay = document.getElementById('loading-overlay');
            overlay.style.opacity = '0';
            setTimeout(() => {
                overlay.style.display = 'none';
                overlay.style.opacity = '1';
            }, 300);
        }

        // Check authentication and show/hide admin button
        firebase.auth().onAuthStateChanged(function(user) {
            const adminLink = document.getElementById('admin-link');
            const adminLinkMobile = document.getElementById('admin-link-mobile');
            
            if (user) {
                // User is logged in, show admin button
                adminLink.classList.remove('hidden');
                adminLinkMobile.classList.remove('hidden');
                console.log('✅ User authenticated, showing admin button');
            } else {
                // User is not logged in, hide admin button
                adminLink.classList.add('hidden');
                adminLinkMobile.classList.add('hidden');
                console.log('❌ User not authenticated, hiding admin button');
            }
        });

        // Load project data when page loads
        window.onload = async function() {
            showLoading('Loading project details...');
            
            try {
                await loadProjectData();
                console.log('✅ Project details loaded successfully');
            } catch (error) {
                console.error('❌ Error loading project details:', error);
                alert('Error loading project details. Please refresh the page.');
            } finally {
                hideLoading();
            }
        };

        // Test function for manual scrolling
        function testScroll() {
            const gallery = document.getElementById('screenshots-gallery');
            if (gallery) {
                console.log('Testing scroll functionality');
                console.log('Current scroll position:', gallery.scrollLeft);
                gallery.scrollBy({ left: 272, behavior: 'smooth' });
                console.log('Scroll test completed');
            } else {
                console.error('Gallery not found');
            }
        }

        // Generate star rating display
        function generateStarRating(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let starsHTML = '';
            
            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<span class="text-yellow-400">★</span>';
            }
            
            // Half star
            if (hasHalfStar) {
                starsHTML += '<span class="text-yellow-400">☆</span>';
            }
            
            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<span class="text-gray-300">☆</span>';
            }
            
            return starsHTML;
        }

        // Note: Image URL testing functions removed to prevent rate limiting issues
        // Images are now tested naturally through the img element's onload/onerror events

        // Manual function to retry loading failed images with intelligent rate limiting
        async function retryFailedImages() {
            const failedImages = document.querySelectorAll('#screenshots-gallery img[src="images/appstore.png"]');
            console.log(`🔄 Retrying ${failedImages.length} failed images with intelligent rate limiting...`);
            
            if (failedImages.length === 0) {
                console.log('✅ No failed images to retry');
                return;
            }
            
            // Show retry progress
            const retryButton = document.querySelector('button[onclick="retryFailedImages()"]');
            if (retryButton) {
                retryButton.textContent = 'Retrying...';
                retryButton.disabled = true;
            }
            
            for (let i = 0; i < failedImages.length; i++) {
                const img = failedImages[i];
                const originalSrc = img.dataset.originalSrc;
                
                if (originalSrc) {
                    console.log(`🔄 Retrying image ${i + 1}/${failedImages.length}: ${originalSrc}`);
                    
                    // Show loading state for this specific image
                    const index = img.dataset.screenshotIndex;
                    if (index !== undefined) {
                        showLoadingState(index);
                    }
                    
                    // Use longer delays to avoid rate limiting (5s, 10s, 15s...)
                    const delay = 5000 + (i * 5000); // 5s, 10s, 15s, 20s...
                    console.log(`⏰ Waiting ${delay/1000}s before retry ${i + 1} to avoid rate limiting`);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    
                    // Try to reload the image
                    img.src = originalSrc;
                    
                    // Additional delay between retries
                    await new Promise(resolve => setTimeout(resolve, 2000));
                }
            }
            
            // Reset button and update progress
            if (retryButton) {
                retryButton.textContent = 'Retry Failed Images';
                retryButton.disabled = false;
            }
            
            // Update progress after retry
            setTimeout(() => {
                updateProgress();
            }, 3000);
        }

        // Function to manually reload all screenshots
        async function reloadAllScreenshots() {
            console.log('🔄 Reloading all screenshots...');
            const project = await getCurrentProject();
            if (project) {
                await loadScreenshots(project);
            }
        }

        // Helper function to get current project data
        async function getCurrentProject() {
            try {
                const projects = await FirebaseDB.getProjects();
                const urlParams = new URLSearchParams(window.location.search);
                const projectIndex = parseInt(urlParams.get('project')) || 0;
                return projects[projectIndex];
            } catch (error) {
                console.error('Error getting current project:', error);
                return null;
            }
        }

        // Hide loading state for a specific screenshot
        function hideLoadingState(index) {
            const loadingElement = document.getElementById(`loading-${index}`);
            if (loadingElement) {
                loadingElement.style.opacity = '0';
                setTimeout(() => {
                    loadingElement.style.display = 'none';
                }, 300);
            }
        }

        // Show loading state for a specific screenshot (for retry)
        function showLoadingState(index) {
            const loadingElement = document.getElementById(`loading-${index}`);
            const failedElement = document.getElementById(`failed-${index}`);
            if (loadingElement) {
                loadingElement.style.display = 'flex';
                loadingElement.style.opacity = '1';
            }
            // Hide failed state when retrying
            if (failedElement) {
                failedElement.style.display = 'none';
            }
        }

        // Show failed state for a specific screenshot
        function showFailedState(index) {
            const failedElement = document.getElementById(`failed-${index}`);
            if (failedElement) {
                failedElement.style.display = 'flex';
            }
        }

        // Hide failed state for a specific screenshot
        function hideFailedState(index) {
            const failedElement = document.getElementById(`failed-${index}`);
            if (failedElement) {
                failedElement.style.display = 'none';
            }
        }

        // Hide modal loading state
        function hideModalLoading() {
            const modalLoading = document.getElementById('modal-loading');
            if (modalLoading) {
                modalLoading.style.display = 'none';
            }
        }

        // Show failed image state in modal
        function showFailedImageInModal() {
            const modalFailed = document.getElementById('modal-failed');
            if (modalFailed) {
                modalFailed.style.display = 'flex';
            }
        }

        // Hide failed image state in modal
        function hideFailedImageInModal() {
            const modalFailed = document.getElementById('modal-failed');
            if (modalFailed) {
                modalFailed.style.display = 'none';
            }
        }

        // Retry the current modal image
        function retryCurrentModalImage() {
            if (currentScreenshots.length === 0 || currentScreenshotIndex < 0) return;
            
            const currentScreenshot = currentScreenshots[currentScreenshotIndex];
            console.log('🔄 Retrying current modal image:', currentScreenshot);
            
            // Reset modal states
            hideFailedImageInModal();
            
            // Update modal content (this will trigger loading state)
            updateModalContent(currentScreenshot, currentScreenshotIndex + 1, currentScreenshots.length);
            
            // Also retry the corresponding gallery image
            const galleryIndex = currentScreenshot.index;
            if (galleryIndex !== undefined) {
                retrySingleImage(galleryIndex);
            }
        }

        // Retry a single image
        async function retrySingleImage(index) {
            console.log(`🔄 Retrying single image at index ${index}`);
            
            const img = document.querySelector(`img[data-screenshot-index="${index}"]`);
            if (!img) {
                console.error('Image element not found for retry');
                return;
            }
            
            const originalSrc = img.dataset.originalSrc;
            if (!originalSrc) {
                console.error('No original source found for retry');
                return;
            }
            
            // Show loading state
            showLoadingState(index);
            
            // Reset image source to trigger loading
            img.src = originalSrc;
            
            // Add a small delay to ensure the loading state is visible
            await new Promise(resolve => setTimeout(resolve, 100));
            
            console.log(`🔄 Retrying image: ${originalSrc}`);
            
            // Set a timeout to handle cases where the image doesn't load or fails again
            setTimeout(() => {
                // Check if the image is still loading (hasn't triggered onload or onerror)
                if (img.src === originalSrc && !img.complete) {
                    console.log(`⏰ Image retry timeout for index ${index}`);
                    // Force show failed state if image is still loading after timeout
                    hideLoadingState(index);
                    showFailedState(index);
                }
            }, 10000); // 10 second timeout
        }

        // Show loading progress for individual images
        function updateImageLoadingProgress(loadedCount, totalCount) {
            const progressText = document.querySelector('.image-loading-progress');
            if (progressText) {
                if (loadedCount === totalCount) {
                    progressText.textContent = `All ${totalCount} images loaded successfully!`;
                    progressText.className = 'text-sm text-green-600 font-medium';
                } else {
                    progressText.textContent = `Images loaded: ${loadedCount}/${totalCount}`;
                    progressText.className = 'text-sm text-gray-500';
                }
            }
        }

        // Function to suggest alternative solutions for rate-limited images
        function showImageAlternatives() {
            const helpMessage = document.createElement('div');
            helpMessage.className = 'mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg';
            helpMessage.innerHTML = `
                <div class="flex items-start space-x-3">
                    <svg class="w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    <div class="flex-1">
                        <h3 class="text-sm font-medium text-blue-800">Image Loading Tips</h3>
                        <p class="text-sm text-blue-700 mt-1">
                            If screenshots continue to fail, try these solutions:
                        </p>
                        <ul class="text-sm text-blue-600 mt-2 list-disc list-inside space-y-1">
                            <li>Wait a few minutes and refresh the page</li>
                            <li>Use the "Retry Failed Images" button above</li>
                            <li>Check your internet connection</li>
                            <li>Try accessing the page later when Google's servers are less busy</li>
                        </ul>
                    </div>
                </div>
            `;
            
            // Remove any existing help message
            const existingHelp = document.querySelector('.bg-blue-50');
            if (existingHelp) {
                existingHelp.remove();
            }
            
            // Add the new help message
            const gallery = document.getElementById('screenshots-gallery');
            if (gallery && gallery.parentNode) {
                gallery.parentNode.insertBefore(helpMessage, gallery.nextSibling);
            }
        }
    </script>
</body>
</html> 