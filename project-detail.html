<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script>
        // Wait for Firebase to load
        window.addEventListener('load', function() {
            if (typeof firebase !== 'undefined') {
                console.log('✅ Firebase SDK loaded successfully');
            } else {
                console.error('❌ Firebase SDK failed to load');
            }
        });
    </script>
    <script src="firebase-config.js?v=1"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        
        /* Hide scrollbar for webkit browsers */
        .scrollbar-hide {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;  /* Chrome, Safari and Opera */
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 1rem;
            color: #4f46e5;
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 smooth-scroll">
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading project details...</div>
    </div>
    
    <!-- Navbar -->
    <nav class="bg-white shadow-md fixed w-full z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0">
                    <h1 class="text-2xl font-bold text-indigo-600">Project Details</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html#home" class="text-gray-600 hover:text-indigo-600 transition duration-300">Home</a>
                    <a href="index.html#about" class="text-gray-600 hover:text-indigo-600 transition duration-300">About</a>
                    <a href="index.html#career" class="text-gray-600 hover:text-indigo-600 transition duration-300">Career</a>
                    <a href="index.html#skills" class="text-gray-600 hover:text-indigo-600 transition duration-300">Skills</a>
                    <a href="index.html#projects" class="text-gray-600 hover:text-indigo-600 transition duration-300">Projects</a>
                    <a href="index.html#resume" class="text-gray-600 hover:text-indigo-600 transition duration-300">Resume</a>
                    <a href="index.html#contact" class="text-gray-600 hover:text-indigo-600 transition duration-300">Contact</a>
                    <a href="admin.html" id="admin-link" class="text-indigo-600 hover:text-indigo-800 transition duration-300 font-semibold hidden">Admin</a>
                </div>
                <div class="md:hidden">
                    <button id="menu-toggle" class="text-gray-600 hover:text-indigo-600 focus:outline-none">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white shadow-md">
            <div class="px-4 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="index.html#home" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Home</a>
                <a href="index.html#about" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">About</a>
                <a href="index.html#career" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Career</a>
                <a href="index.html#skills" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Skills</a>
                <a href="index.html#projects" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Projects</a>
                <a href="index.html#resume" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Resume</a>
                <a href="index.html#contact" class="block text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md">Contact</a>
                <a href="admin.html" id="admin-link-mobile" class="block text-indigo-600 hover:text-indigo-800 px-3 py-2 rounded-md font-semibold hidden">Admin</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-20 pb-12 bg-gradient-to-r from-indigo-500 to-purple-600 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2 mb-8 md:mb-0">
                    <img src="https://picsum.photos/600/400" alt="Task Manager App" class="rounded-lg shadow-lg">
                </div>
                <div class="md:w-1/2 md:pl-10">
                    <h1 class="text-4xl md:text-5xl font-bold mb-4">Task Manager App</h1>
                    <p class="text-xl mb-6">A comprehensive productivity app built with Flutter, featuring task scheduling, reminders, and cloud synchronization.</p>
                    <div class="flex flex-wrap gap-2 mb-6">
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Flutter</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Dart</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Firebase</span>
                        <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">Cloud Sync</span>
                    </div>
                    <div class="flex space-x-4" id="store-buttons">
                        <!-- Store buttons will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Overview -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h2 class="text-3xl font-bold mb-6">Project Overview</h2>
                    <div id="project-overview-container">
                        <!-- Project overview will be loaded dynamically -->
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold mb-4">Key Features</h3>
                    <div id="key-features-container">
                        <!-- Key features will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Screenshots -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">App Screenshots</h2>
            
            <!-- Screenshot Gallery Container -->
            <div class="relative">
                <!-- Screenshot Gallery -->
                <div id="screenshots-gallery" class="flex overflow-x-auto gap-4 pb-4">
                    <!-- Screenshots will be loaded dynamically -->
                </div>
                
                <!-- Navigation Buttons -->
                <button id="screenshot-prev" class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-800 p-2 rounded-full shadow-lg transition-all duration-300 opacity-1 pointer-events-auto z-10">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="screenshot-next" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-800 p-2 rounded-full shadow-lg transition-all duration-300 opacity-1 pointer-events-auto z-10">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Add Screenshot Button (Admin Only) -->
            <div id="add-screenshot-section" class="text-center mt-8 hidden">
                <button id="add-screenshot-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300">
                    <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    Add Screenshot
                </button>
            </div>
        </div>
    </section>

    <!-- Screenshot Modal -->
    <div id="screenshot-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden z-50 flex items-center justify-center p-4">
        <div class="relative">
            <button id="close-modal" class="absolute top-4 right-4 text-white hover:text-gray-300 z-10">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <img id="modal-image" src="" alt="" class="max-w-full max-h-screen object-contain">
        </div>
    </div>

    <!-- Technical Details -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Technical Implementation</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h3 class="text-2xl font-bold mb-6">Tech Stack</h3>
                    <div id="tech-stack-container" class="space-y-4">
                        <!-- Tech stack items will be dynamically loaded here -->
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold mb-6">Development Process</h3>
                    <div id="development-process-container" class="space-y-6">
                        <!-- Development process items will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Challenges & Solutions -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Challenges & Solutions</h2>
            <div id="challenges-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Dynamic challenges and solutions will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Results & Impact -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Results & Impact</h2>
            <div id="results-container" class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <!-- Results and impact will be loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Back to Portfolio -->
    <section class="py-16 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-bold mb-6">View More Projects</h2>
            <p class="text-lg text-gray-600 mb-8">Explore other projects in my portfolio</p>
            <a href="index.html#projects" class="bg-indigo-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300">Back to Portfolio</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-indigo-600 text-white py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 [Your Name]. All rights reserved.</p>
        </div>
    </footer>

    <script>
                // Load project data from Firebase
        async function loadProjectData() {
            try {
            const urlParams = new URLSearchParams(window.location.search);
            const projectIndex = urlParams.get('project');
                
                console.log('Loading project data for index:', projectIndex);
            
            if (projectIndex !== null) {
                    const projects = await FirebaseDB.getProjects();
                    console.log('Loaded projects:', projects);
                    
                    const project = projects[parseInt(projectIndex)];
                    console.log('Selected project:', project);
                    
                    if (project) {
                        // Update hero section
                        const heroTitle = document.querySelector('.md\\:w-1\\/2 h1');
                        const heroDescription = document.querySelector('.md\\:w-1\\/2 p');
                        const heroImage = document.querySelector('section img');
                        
                        if (heroTitle) heroTitle.textContent = project.name;
                        if (heroDescription) heroDescription.textContent = project.description;
                        if (heroImage && project.image) heroImage.src = project.image;
                        
                        // Update tech stack tags
                        if (project.tech) {
                            const techTags = project.tech.split(',').map(tech => tech.trim());
                            const tagsContainer = document.querySelector('.md\\:w-1\\/2 .flex.flex-wrap.gap-2');
                            if (tagsContainer) {
                                tagsContainer.innerHTML = '';
                                
                                techTags.forEach(tech => {
                                    const tag = document.createElement('span');
                                    tag.className = 'bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm';
                                    tag.textContent = tech;
                                    tagsContainer.appendChild(tag);
                                });
                            }
                        }
                        
                        // Update store buttons - only show if URLs exist
                        const storeButtonsContainer = document.getElementById('store-buttons');
                        if (storeButtonsContainer) {
                            storeButtonsContainer.innerHTML = '';
                            
                            // Add Google Play button if demo URL exists
                            if (project.demo && project.demo.trim() !== '') {
                                const playStoreLink = document.createElement('a');
                                playStoreLink.href = project.demo;
                                playStoreLink.className = 'hover:opacity-80 transition duration-300';
                                playStoreLink.innerHTML = `<img src="images/playstore.png" alt="Get it on Google Play" class="h-12">`;
                                storeButtonsContainer.appendChild(playStoreLink);
                            }
                            
                            // Add App Store button if source URL exists
                            if (project.source && project.source.trim() !== '') {
                                const appStoreLink = document.createElement('a');
                                appStoreLink.href = project.source;
                                appStoreLink.className = 'hover:opacity-80 transition duration-300';
                                appStoreLink.innerHTML = `<img src="images/appstore.png" alt="Download on the App Store" class="h-12">`;
                                storeButtonsContainer.appendChild(appStoreLink);
                            }
                        }
                        

                        
                        // Update Technical Implementation section
                        console.log('🔍 Full project data loaded:', project);
                        console.log('🔍 All project keys:', Object.keys(project));
                        console.log('🔍 Tech Stack from Firebase:', project.techStack);
                        console.log('🔍 Development Process from Firebase:', project.developmentProcess);
                        console.log('🔍 Project tech field:', project.tech);
                        console.log('🔍 Raw project object:', JSON.stringify(project, null, 2));
                        
                        // Check multiple possible field names for tech stack
                        const techStackData = project.techStack || project.tech || project.technicalStack;
                        console.log('🔍 Tech stack data found:', techStackData);
                        
                        if (techStackData) {
                            console.log('Tech stack data:', techStackData);
                            // Handle both comma-separated and newline-separated formats
                            const techStackItems = techStackData.includes('\n') 
                                ? techStackData.split('\n') 
                                : techStackData.split(',');
                            console.log('Tech stack items:', techStackItems);
                            
                            const techStackContainer = document.getElementById('tech-stack-container');
                            console.log('Tech Stack container found:', techStackContainer);
                            
                            if (techStackContainer) {
                                console.log('Updating tech stack container');
                                techStackContainer.innerHTML = '';
                                
                                techStackItems.forEach(item => {
                                    if (item.trim()) {
                                        const [technology, description] = item.split('|');
                                        if (technology && description) {
                                            const techDiv = document.createElement('div');
                                            techDiv.className = 'flex justify-between items-center p-4 bg-gray-50 rounded-lg';
                                            techDiv.innerHTML = `
                                                <span class="font-semibold">${technology.trim()}</span>
                                                <span class="text-indigo-600">${description.trim()}</span>
                                            `;
                                            techStackContainer.appendChild(techDiv);
                                            console.log('Added tech item:', technology, description);
                                        }
                                    }
                                });
                            } else {
                                console.error('Tech stack container not found');
                            }
                        } else {
                            console.log('No tech stack data found in project');
                        }
                        
                        // Check multiple possible field names for development process
                        const developmentProcessData = project.developmentProcess || project.process || project.development;
                        console.log('🔍 Development process data found:', developmentProcessData);
                        
                        if (developmentProcessData) {
                            console.log('Development process data:', developmentProcessData);
                            // Handle both comma-separated and newline-separated formats
                            const processItems = developmentProcessData.includes('\n') 
                                ? developmentProcessData.split('\n') 
                                : developmentProcessData.split(',');
                            console.log('Process items:', processItems);
                            
                            const processContainer = document.getElementById('development-process-container');
                            console.log('Development Process container found:', processContainer);
                            
                            if (processContainer) {
                                console.log('Updating development process container');
                                processContainer.innerHTML = '';
                                
                                processItems.forEach((item, index) => {
                                    if (item.trim()) {
                                        const [step, description] = item.split('|');
                                        if (step && description) {
                                            const processDiv = document.createElement('div');
                                            processDiv.className = 'flex items-start mb-6';
                                            processDiv.innerHTML = `
                                                <div class="bg-indigo-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-sm mr-6 flex-shrink-0 shadow-md">${index + 1}</div>
                                                <div class="flex-1">
                                                    <h4 class="font-semibold text-lg mb-2 text-gray-800">${step.trim()}</h4>
                                                    <p class="text-gray-600 leading-relaxed">${description.trim()}</p>
                                                </div>
                                            `;
                                            processContainer.appendChild(processDiv);
                                            console.log('Added process item:', step, description);
                                        }
                                    }
                                });
                            } else {
                                console.error('Development process container not found');
                            }
                        } else {
                            console.log('No development process data found in project');
                        }
                        
                        // Load project overview and key features
                        loadProjectOverview(project);
                        loadKeyFeatures(project);
                        loadResultsAndImpact(project);
                        
                        // Load challenges and solutions
                        loadChallengesAndSolutions(project);
                        
                        // Load screenshots
                        await loadScreenshots(project);
                        
                        // Update footer with portfolio owner name
                        try {
                            const portfolioData = await FirebaseDB.getPortfolioData();
                            if (portfolioData.heroName) {
                                document.querySelector('footer p').textContent = `© 2025 ${portfolioData.heroName}. All rights reserved.`;
                            }
                        } catch (error) {
                            console.error('Error updating footer:', error);
                        }
                    } else {
                        console.error('Project not found for index:', projectIndex);
                    }
                } else {
                    console.error('No project index provided in URL');
                }
            } catch (error) {
                console.error('Error loading project data:', error);
                console.error('Error details:', error.message);
                console.error('Error stack:', error.stack);
            }
        }

        // Load project overview for the project
        function loadProjectOverview(project) {
            try {
                console.log('Loading project overview for project:', project);
                const overviewContainer = document.getElementById('project-overview-container');
                
                if (!overviewContainer) {
                    console.error('Project overview container element not found');
                    return;
                }
                
                overviewContainer.innerHTML = '';
                
                if (project.detailDescription && project.detailDescription.trim()) {
                    console.log('Found project overview data:', project.detailDescription);
                    overviewContainer.innerHTML = `
                        <p class="text-lg text-gray-600 leading-relaxed mb-6">${project.detailDescription}</p>
                    `;
                } else {
                    console.log('No project overview data found');
                    overviewContainer.innerHTML = '<p class="text-lg text-gray-600 leading-relaxed">No project overview available.</p>';
                }
            } catch (error) {
                console.error('Error loading project overview:', error);
            }
        }

        // Load key features for the project
        function loadKeyFeatures(project) {
            try {
                console.log('Loading key features for project:', project);
                const featuresContainer = document.getElementById('key-features-container');
                
                if (!featuresContainer) {
                    console.error('Key features container element not found');
                    return;
                }
                
                featuresContainer.innerHTML = '';
                
                if (project.features && project.features.trim()) {
                    console.log('Found features data:', project.features);
                    const features = project.features.split('\n');
                    
                    const featuresList = document.createElement('ul');
                    featuresList.className = 'space-y-3';
                    
                    features.forEach(feature => {
                        if (feature.trim()) {
                            const li = document.createElement('li');
                            li.className = 'flex items-start mb-4';
                            li.innerHTML = `
                                <div class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm mr-4 flex-shrink-0 shadow-sm">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <span class="text-gray-800 font-medium leading-relaxed">${feature.trim()}</span>
                                </div>
                            `;
                            featuresList.appendChild(li);
                        }
                    });
                    
                    featuresContainer.appendChild(featuresList);
                } else {
                    console.log('No features data found');
                    featuresContainer.innerHTML = '<p class="text-gray-600">No key features available.</p>';
                }
            } catch (error) {
                console.error('Error loading key features:', error);
            }
        }

        // Load results and impact for the project
        function loadResultsAndImpact(project) {
            try {
                console.log('Loading results and impact for project:', project);
                const resultsContainer = document.getElementById('results-container');
                
                if (!resultsContainer) {
                    console.error('Results container element not found');
                    return;
                }
                
                resultsContainer.innerHTML = '';
                
                // Create result cards based on available data
                const resultCards = [];
                
                if (project.users) {
                    resultCards.push({
                        value: project.users,
                        label: 'Active Users'
                    });
                }
                
                if (project.rating) {
                    const ratingValue = parseFloat(project.rating);
                    if (!isNaN(ratingValue)) {
                        resultCards.push({
                            value: generateStarRating(ratingValue),
                            label: 'App Store Rating'
                        });
                    } else {
                        resultCards.push({
                            value: project.rating,
                            label: 'App Store Rating'
                        });
                    }
                }
                
                if (project.retention) {
                    resultCards.push({
                        value: project.retention,
                        label: 'User Retention'
                    });
                }
                
                if (resultCards.length > 0) {
                    resultCards.forEach(card => {
                        const cardDiv = document.createElement('div');
                        cardDiv.className = 'bg-indigo-50 rounded-lg p-6';
                        cardDiv.innerHTML = `
                            <div class="text-4xl font-bold text-indigo-600 mb-2">${card.value}</div>
                            <p class="text-gray-600">${card.label}</p>
                        `;
                        resultsContainer.appendChild(cardDiv);
                    });
                } else {
                    console.log('No results data found');
                    const noResultsDiv = document.createElement('div');
                    noResultsDiv.className = 'col-span-full text-center text-gray-500 py-8';
                    noResultsDiv.innerHTML = '<p>No results and impact data available for this project.</p>';
                    resultsContainer.appendChild(noResultsDiv);
                }
            } catch (error) {
                console.error('Error loading results and impact:', error);
            }
        }

        // Load challenges and solutions for the project
        function loadChallengesAndSolutions(project) {
            try {
                console.log('Loading challenges and solutions for project:', project);
                const challengesContainer = document.getElementById('challenges-container');
                
                if (!challengesContainer) {
                    console.error('Challenges container element not found');
                    return;
                }
                
                challengesContainer.innerHTML = '';
                
                if (project.challenges && project.challenges.trim()) {
                    console.log('Found challenges data:', project.challenges);
                    const challenges = project.challenges.split('\n');
                    
                    challenges.forEach(challenge => {
                        if (challenge.trim()) {
                            const [challengeText, solutionText] = challenge.split('|');
                            if (challengeText && solutionText) {
                                const challengeCard = document.createElement('div');
                                challengeCard.className = 'bg-white rounded-lg p-6 shadow-md';
                                challengeCard.innerHTML = `
                                    <h3 class="text-xl font-bold mb-4 text-red-600">Challenge</h3>
                                    <p class="text-gray-600 mb-4">${challengeText.trim()}</p>
                                    <h4 class="font-semibold mb-2">Solution</h4>
                                    <p class="text-gray-600">${solutionText.trim()}</p>
                                `;
                                challengesContainer.appendChild(challengeCard);
                                console.log('Added challenge card:', challengeText, solutionText);
                            }
                        }
                    });
                } else {
                    console.log('No challenges data found in project');
                    // Show a default message if no challenges are available
                    const noChallengesCard = document.createElement('div');
                    noChallengesCard.className = 'col-span-full text-center text-gray-500 py-8';
                    noChallengesCard.innerHTML = '<p>No challenges and solutions data available for this project.</p>';
                    challengesContainer.appendChild(noChallengesCard);
                }
            } catch (error) {
                console.error('Error loading challenges and solutions:', error);
            }
        }

        // Load screenshots for the project
        async function loadScreenshots(project) {
            try {
                console.log('Loading screenshots for project:', project);
                const gallery = document.getElementById('screenshots-gallery');
                
                if (!gallery) {
                    console.error('Screenshots gallery element not found');
                    return;
                }
                
                gallery.innerHTML = '';
                
                if (project.screenshots && project.screenshots.length > 0) {
                    console.log('Found screenshots:', project.screenshots);
                    project.screenshots.forEach((screenshot, index) => {
                        console.log('Creating screenshot card:', screenshot);
                        const screenshotCard = createScreenshotCard(screenshot, index);
                        if (screenshotCard) { // Only append if card was created successfully
                            gallery.appendChild(screenshotCard);
                        }
                    });
                    
                    // Setup navigation buttons
                    setupScreenshotNavigation();
                } else {
                    console.log('No screenshots found for project');
                    // Show placeholder if no screenshots
                    gallery.innerHTML = `
                        <div class="flex items-center justify-center w-full py-12">
                            <div class="text-center">
                                <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <p class="text-gray-500 text-lg">No screenshots available yet</p>
                                <p class="text-gray-400">Screenshots will appear here once added</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading screenshots:', error);
                console.error('Error details:', error.message);
                console.error('Error stack:', error.stack);
            }
        }

        // Create screenshot card
        function createScreenshotCard(screenshot, index) {
            try {
                console.log('Creating screenshot card with data:', screenshot);
                
                if (!screenshot || !screenshot.url || !screenshot.title) {
                    console.error('Invalid screenshot data:', screenshot);
                    return null;
                }
                
                const card = document.createElement('div');
                card.className = 'flex-shrink-0 w-56 h-112 rounded-lg overflow-hidden shadow-lg cursor-pointer transform hover:scale-105 transition duration-300';
                card.innerHTML = `
                    <div class="relative w-full h-full bg-gray-900 rounded-lg p-2">
                        <!-- Phone Frame -->
                        <div class="w-full h-full bg-gray-800 rounded-lg overflow-hidden relative">
                            <!-- Screenshot Image (Full Size) -->
                            <img src="${screenshot.url}" alt="${screenshot.title}" class="w-full h-full object-contain mt-6" data-screenshot-index="${index}">
                            
                            <!-- Status Bar Overlay -->
                            <div class="absolute top-0 left-0 right-0 h-6 bg-black bg-opacity-80 flex items-center justify-between px-3 z-10">
                                <div class="flex items-center space-x-1">
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                    <div class="w-2 h-2 bg-white rounded-full"></div>
                                </div>
                                <div class="text-white text-xs font-medium">9:41</div>
                                <div class="flex items-center space-x-1">
                                    <div class="w-3 h-2 bg-white rounded-sm"></div>
                                    <div class="w-1 h-1 bg-white rounded-full"></div>
                                </div>
                            </div>
                            
                            <!-- Home Indicator Overlay -->
                            <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 w-32 h-1 bg-white rounded-full opacity-80"></div>
                        </div>
                    </div>
                `;
                
                // Add click event to open modal
                card.addEventListener('click', () => {
                    openScreenshotModal(screenshot);
                });
                
                return card;
            } catch (error) {
                console.error('Error creating screenshot card:', error);
                console.error('Screenshot data:', screenshot);
                return null;
            }
        }

        // Open screenshot modal
        function openScreenshotModal(screenshot) {
            try {
                console.log('Opening screenshot modal:', screenshot);
                
                if (!screenshot || !screenshot.url) {
                    console.error('Invalid screenshot data for modal:', screenshot);
                    return;
                }
                
                const modal = document.getElementById('screenshot-modal');
                const modalImage = document.getElementById('modal-image');
                
                if (!modal || !modalImage) {
                    console.error('Modal elements not found');
                    return;
                }
                
                modalImage.src = screenshot.url;
                modalImage.alt = screenshot.title || 'Screenshot';
                
                modal.classList.remove('hidden');
            } catch (error) {
                console.error('Error opening screenshot modal:', error);
            }
        }

        // Close screenshot modal
        function closeScreenshotModal() {
            const modal = document.getElementById('screenshot-modal');
            modal.classList.add('hidden');
        }

        // Setup screenshot navigation
        function setupScreenshotNavigation() {
            const gallery = document.getElementById('screenshots-gallery');
            const prevBtn = document.getElementById('screenshot-prev');
            const nextBtn = document.getElementById('screenshot-next');
            
            console.log('Setting up screenshot navigation');
            console.log('Gallery:', gallery);
            console.log('Prev button:', prevBtn);
            console.log('Next button:', nextBtn);
            
            if (!gallery || !prevBtn || !nextBtn) {
                console.error('Navigation elements not found');
                return;
            }
            
            // Navigation button click handlers
            prevBtn.addEventListener('click', () => {
                console.log('Previous button clicked');
                gallery.scrollBy({ left: -240, behavior: 'smooth' }); // 224px card + 16px gap
            });
            
            nextBtn.addEventListener('click', () => {
                console.log('Next button clicked');
                gallery.scrollBy({ left: 240, behavior: 'smooth' }); // 224px card + 16px gap
            });
            
            // Show/hide navigation buttons based on scroll position
            function updateNavigationButtons() {
                const isAtStart = gallery.scrollLeft === 0;
                const isAtEnd = gallery.scrollLeft >= gallery.scrollWidth - gallery.clientWidth;
                
                console.log('Scroll position:', gallery.scrollLeft);
                console.log('Scroll width:', gallery.scrollWidth);
                console.log('Client width:', gallery.clientWidth);
                console.log('Is at start:', isAtStart);
                console.log('Is at end:', isAtEnd);
                
                prevBtn.style.opacity = isAtStart ? '0.3' : '1';
                prevBtn.style.pointerEvents = isAtStart ? 'none' : 'auto';
                
                nextBtn.style.opacity = isAtEnd ? '0.3' : '1';
                nextBtn.style.pointerEvents = isAtEnd ? 'none' : 'auto';
            }
            
            // Update buttons on scroll
            gallery.addEventListener('scroll', updateNavigationButtons);
            
            // Initial button state
            updateNavigationButtons();
            
            console.log('Screenshot navigation setup complete');
        }

        // Mobile menu toggle
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Screenshot modal event listeners
        const closeModalBtn = document.getElementById('close-modal');
        const screenshotModal = document.getElementById('screenshot-modal');
        
        closeModalBtn.addEventListener('click', closeScreenshotModal);
        
        // Close modal when clicking outside
        screenshotModal.addEventListener('click', (e) => {
            if (e.target === screenshotModal) {
                closeScreenshotModal();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !screenshotModal.classList.contains('hidden')) {
                closeScreenshotModal();
            }
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
                // Close mobile menu after clicking a link
                mobileMenu.classList.add('hidden');
            });
        });

        // Show loading overlay
        function showLoading(message = 'Loading...') {
            const overlay = document.getElementById('loading-overlay');
            const loadingText = overlay.querySelector('.loading-text');
            loadingText.textContent = message;
            overlay.style.display = 'flex';
        }

        // Hide loading overlay
        function hideLoading() {
            const overlay = document.getElementById('loading-overlay');
            overlay.style.opacity = '0';
            setTimeout(() => {
                overlay.style.display = 'none';
                overlay.style.opacity = '1';
            }, 300);
        }

        // Check authentication and show/hide admin button
        firebase.auth().onAuthStateChanged(function(user) {
            const adminLink = document.getElementById('admin-link');
            const adminLinkMobile = document.getElementById('admin-link-mobile');
            
            if (user) {
                // User is logged in, show admin button
                adminLink.classList.remove('hidden');
                adminLinkMobile.classList.remove('hidden');
                console.log('✅ User authenticated, showing admin button');
            } else {
                // User is not logged in, hide admin button
                adminLink.classList.add('hidden');
                adminLinkMobile.classList.add('hidden');
                console.log('❌ User not authenticated, hiding admin button');
            }
        });

        // Load project data when page loads
        window.onload = async function() {
            showLoading('Loading project details...');
            
            try {
                await loadProjectData();
                console.log('✅ Project details loaded successfully');
            } catch (error) {
                console.error('❌ Error loading project details:', error);
                alert('Error loading project details. Please refresh the page.');
            } finally {
                hideLoading();
            }
        };

        // Test function for manual scrolling
        function testScroll() {
            const gallery = document.getElementById('screenshots-gallery');
            if (gallery) {
                console.log('Testing scroll functionality');
                console.log('Current scroll position:', gallery.scrollLeft);
                gallery.scrollBy({ left: 240, behavior: 'smooth' });
                console.log('Scroll test completed');
            } else {
                console.error('Gallery not found');
            }
        }

        // Generate star rating display
        function generateStarRating(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let starsHTML = '';
            
            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<span class="text-yellow-400">★</span>';
            }
            
            // Half star
            if (hasHalfStar) {
                starsHTML += '<span class="text-yellow-400">☆</span>';
            }
            
            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<span class="text-gray-300">☆</span>';
            }
            
            return starsHTML;
        }
    </script>
</body>
</html> 